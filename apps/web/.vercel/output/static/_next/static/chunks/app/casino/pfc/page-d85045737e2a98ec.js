(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[948],{167:(e,t,r)=>{"use strict";r.d(t,{Balance:()=>n});var a=r(8481),s=r(8521),l=r(8526);function n(e){let{initialBalance:t}=e,{displayBalance:r,intensity:n}=(0,s.A)(t),c=(0,l.useMemo)(()=>{if(n<.1)return{};let e=3*n,t=+n;return{animation:n>.3?"shake ".concat(.1-.05*n,"s infinite"):"none",transform:"translate(".concat((Math.random()-.5)*e,"px, ").concat((Math.random()-.5)*e,"px) rotate(").concat((Math.random()-.5)*t,"deg)")}},[n]),i=(0,l.useMemo)(()=>n>.7?"text-green-400":n>.4?"text-green-200":"text-[var(--text)]",[n]);return(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center p-6 border-y border-[var(--line)] w-full bg-[rgba(255,255,255,0.02)]",children:[(0,a.jsx)("p",{className:"text-[0.7rem] text-[var(--text-muted)] mb-2 uppercase tracking-widest",children:"solde"}),(0,a.jsxs)("div",{className:"text-[2.5rem] font-light leading-none tracking-tight transition-colors duration-100 ".concat(i),style:c,children:[(0,a.jsx)("span",{className:"tabular-nums",children:r.toFixed(2)}),(0,a.jsx)("span",{className:"text-[var(--text-muted)] text-[1.2rem] ml-1",children:"€"})]})]})}},4460:(e,t,r)=>{Promise.resolve().then(r.bind(r,7159))},6951:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{callServer:function(){return a.callServer},createServerReference:function(){return l.createServerReference},findSourceMapURL:function(){return s.findSourceMapURL}});let a=r(7932),s=r(8208),l=r(1212)},7159:(e,t,r)=>{"use strict";r.d(t,{PFCGameClient:()=>b});var a=r(8481),s=r(8526),l=r(4816),n=r.n(l),c=r(6951);let i=(0,c.createServerReference)("009ad18f4abf74528ce27917ad9973bf362824ca9c",c.callServer,void 0,c.findSourceMapURL,"getPendingPFCChallenges"),d=(0,c.createServerReference)("607d5ff47a0d63789481aaae9c9fc1e8ed6294cf82",c.callServer,void 0,c.findSourceMapURL,"playPFCVsBot"),o=(0,c.createServerReference)("605ef0803833503d650c8e1ca43587cd040252aed3",c.callServer,void 0,c.findSourceMapURL,"createPFCChallenge"),x=(0,c.createServerReference)("4029a3f449e3f61728c6c1d15956f8fc68919736bd",c.callServer,void 0,c.findSourceMapURL,"acceptPFCChallenge"),m=(0,c.createServerReference)("60c8fbe8a36cc860cd08a3455dce3a13b1f5f25562",c.callServer,void 0,c.findSourceMapURL,"makePFCChoice");var u=r(9381),p=r(167),v=r(8521);let h=[{choice:"pierre",emoji:"\uD83E\uDEA8"},{choice:"feuille",emoji:"\uD83D\uDCC4"},{choice:"ciseaux",emoji:"✂️"}];function f(e){var t;let{userBalance:r,userName:l}=e,[c,f]=(0,s.useState)("bot"),[b,j]=(0,s.useState)("1"),[g,N]=(0,s.useState)(!1),[y,w]=(0,s.useState)(null),[C,S]=(0,s.useState)(!1),[k,D]=(0,s.useState)(null),[F,M]=(0,s.useState)("\uD83E\uDD14"),{refreshBalance:R}=(0,v.A)(r),[P,E]=(0,s.useState)([]),[L,B]=(0,s.useState)({sent:[],received:[],playing:[]}),[U,A]=(0,s.useState)(null);(0,s.useEffect)(()=>{if("pvp"===c){_();let e=setInterval(_,3e3);return()=>clearInterval(e)}},[c]),(0,s.useEffect)(()=>{if(C){let e=["\uD83E\uDD14","\uD83E\uDEA8","\uD83D\uDCC4","✂️"],t=0,r=setInterval(()=>{t=(t+1)%e.length,M(e[t])},150);return()=>clearInterval(r)}},[C]);let _=async()=>{let[e,t]=await Promise.all([(0,u.M)(),i()]);E(e),B(t)},I=e=>{var t;return(null==(t=h.find(t=>t.choice===e))?void 0:t.emoji)||""},O=async e=>{let t=parseFloat(b);if(isNaN(t)||t<.5)return;N(!0),w(null),D(e),S(!0);let r=await d(e,t);await new Promise(e=>setTimeout(e,1200)),w(r),S(!1),N(!1),r.success&&R()},T=async e=>{let t=parseFloat(b);isNaN(t)||t<.5||(N(!0),await o(e.id,t),N(!1),_())},q=async e=>{N(!0),await x(e.id),N(!1),R(),_()},G=async(e,t)=>{N(!0),S(!0),D(t),await new Promise(e=>setTimeout(e,800));let r=await m(e.id,t);S(!1),N(!1),r.success&&!r.waiting&&(A({won:r.profit>0,tie:null===r.winnerId,myChoice:t,theirChoice:r.player1Choice===t?r.player2Choice:r.player1Choice,profit:r.profit}),R()),_()},V=()=>{w(null),D(null),A(null)},z=y?y.won?"win":y.tie?"tie":"lose":"idle";return(0,a.jsxs)("main",{className:"min-h-screen flex flex-col",children:[(0,a.jsxs)("header",{className:"flex items-center justify-between p-4 border-b border-[var(--line)]",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(n(),{href:"/casino",className:"text-[var(--text-muted)] hover:text-[var(--text)] transition-colors text-sm",children:"← casino"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"w-2 h-2 rounded-full bg-green-500"}),(0,a.jsx)("span",{className:"text-sm text-[var(--text-muted)]",children:"pfc"})]})]}),(0,a.jsx)("div",{className:"text-sm text-[var(--text-muted)]",children:l.toLowerCase()})]}),(0,a.jsxs)("div",{className:"flex-1 flex flex-col lg:flex-row",children:[(0,a.jsx)("div",{className:"flex-1 h-[50vh] lg:h-auto relative flex items-center justify-center bg-[rgba(255,255,255,0.01)]",children:"bot"===c?(0,a.jsxs)("div",{className:"flex flex-col items-center gap-8",children:[!y&&!k&&(0,a.jsxs)("div",{className:"flex flex-col items-center gap-6",children:[(0,a.jsx)("p",{className:"text-[0.65rem] uppercase tracking-[0.2em] text-[var(--text-muted)]",children:"choisis"}),(0,a.jsx)("div",{className:"flex gap-4",children:h.map(e=>{let{choice:t,emoji:r}=e;return(0,a.jsx)("button",{onClick:()=>O(t),disabled:g||.5>parseFloat(b),className:"w-24 h-24 lg:w-28 lg:h-28 flex items-center justify-center text-5xl lg:text-6xl border border-[var(--line)] hover:border-[var(--text-muted)] hover:bg-[rgba(255,255,255,0.02)] disabled:opacity-50 transition-all",children:r},t)})})]}),(k||y)&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-center gap-8 lg:gap-16",children:[(0,a.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,a.jsx)("span",{className:"text-[0.65rem] uppercase tracking-[0.2em] text-[var(--text-muted)]",children:"toi"}),(0,a.jsx)("div",{className:"w-24 h-24 lg:w-28 lg:h-28 flex items-center justify-center text-5xl lg:text-6xl border border-[var(--line)]",children:k?I(k):"?"})]}),(0,a.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,a.jsx)("div",{className:"w-px h-12 bg-[var(--line)]"}),(0,a.jsx)("span",{className:"text-xs text-[var(--text-muted)] font-light",children:"vs"}),(0,a.jsx)("div",{className:"w-px h-12 bg-[var(--line)]"})]}),(0,a.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,a.jsx)("span",{className:"text-[0.65rem] uppercase tracking-[0.2em] text-[var(--text-muted)]",children:"bot"}),(0,a.jsx)("div",{className:"w-24 h-24 lg:w-28 lg:h-28 flex items-center justify-center text-5xl lg:text-6xl border border-[var(--line)] ".concat(C?"animate-pulse":""),children:(null==y?void 0:y.botChoice)?I(y.botChoice):F})]})]}),y&&y.success&&!C&&(0,a.jsx)("div",{className:"px-8 py-3 ".concat("win"===z?"bg-green-500/10 border border-green-500/30":"tie"===z?"bg-yellow-500/10 border border-yellow-500/30":"bg-red-500/10 border border-red-500/30"),children:(0,a.jsxs)("span",{className:"text-sm font-mono ".concat("win"===z?"text-green-400":"tie"===z?"text-yellow-400":"text-red-400"),children:["win"===z&&"+",null==(t=y.profit)?void 0:t.toFixed(2),"e"]})}),y&&!y.success&&(0,a.jsx)("div",{className:"px-8 py-3 bg-red-500/10 border border-red-500/30",children:(0,a.jsx)("span",{className:"text-sm text-red-400",children:y.error})}),y&&!C&&(0,a.jsx)("button",{onClick:V,className:"text-sm text-[var(--text-muted)] hover:text-[var(--text)] transition-colors",children:"rejouer"})]})]}):(0,a.jsxs)("div",{className:"w-full max-w-md px-6",children:[L.playing.length>0&&!U&&(0,a.jsxs)("div",{className:"flex flex-col items-center gap-6",children:[(0,a.jsx)("p",{className:"text-[0.65rem] uppercase tracking-[0.2em] text-yellow-400",children:"a toi de jouer"}),L.playing.map(e=>{var t,r,s,l;return(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsxs)("p",{className:"text-sm mb-4",children:["vs ",(null==(r=e.player1)||null==(t=r.discordUsername)?void 0:t.toLowerCase())||(null==(l=e.player2)||null==(s=l.discordUsername)?void 0:s.toLowerCase()),(0,a.jsxs)("span",{className:"text-[var(--text-muted)] ml-2",children:["(",String(e.amount),"e)"]})]}),(0,a.jsx)("div",{className:"flex gap-3",children:h.map(t=>{let{choice:r,emoji:s}=t;return(0,a.jsx)("button",{onClick:()=>G(e,r),disabled:g,className:"w-20 h-20 flex items-center justify-center text-4xl border border-[var(--line)] hover:border-yellow-500/50 hover:bg-yellow-500/10 disabled:opacity-50 transition-all",children:s},r)})})]},e.id)})]}),U&&(0,a.jsxs)("div",{className:"flex flex-col items-center gap-6",children:[(0,a.jsx)("div",{className:"text-6xl",children:U.won?"\uD83C\uDFC6":U.tie?"\uD83E\uDD1D":"\uD83D\uDCA8"}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsxs)("p",{className:"text-3xl mb-2",children:[I(U.myChoice)," vs ",I(U.theirChoice)]}),(0,a.jsxs)("p",{className:"text-lg font-mono ".concat(U.won?"text-green-400":U.tie?"text-yellow-400":"text-red-400"),children:[U.profit>0?"+":"",U.profit.toFixed(2),"e"]})]}),(0,a.jsx)("button",{onClick:V,className:"text-sm text-[var(--text-muted)] hover:text-[var(--text)]",children:"continuer"})]}),0===L.playing.length&&!U&&(0,a.jsx)(a.Fragment,{children:L.received.length>0||L.sent.length>0?(0,a.jsxs)("div",{className:"space-y-6",children:[L.received.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-[0.65rem] uppercase tracking-[0.2em] text-[var(--text-muted)] mb-3",children:"defis recus"}),L.received.map(e=>{var t,r;return(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border border-[var(--line)] mb-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm",children:null==(r=e.player1)||null==(t=r.discordUsername)?void 0:t.toLowerCase()}),(0,a.jsxs)("p",{className:"text-xs text-[var(--text-muted)] font-mono",children:[String(e.amount),"e"]})]}),(0,a.jsx)("button",{onClick:()=>q(e),disabled:g,className:"px-4 py-2 text-xs uppercase tracking-wider bg-green-500/20 text-green-400 border border-green-500/50 hover:bg-green-500/30 disabled:opacity-50",children:"jouer"})]},e.id)})]}),L.sent.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-[0.65rem] uppercase tracking-[0.2em] text-[var(--text-muted)] mb-3",children:"en attente"}),L.sent.map(e=>{var t,r;return(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border border-[var(--line)] opacity-60 mb-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm",children:null==(r=e.player2)||null==(t=r.discordUsername)?void 0:t.toLowerCase()}),(0,a.jsxs)("p",{className:"text-xs text-[var(--text-muted)] font-mono",children:[String(e.amount),"e"]})]}),(0,a.jsx)("span",{className:"text-xs text-[var(--text-muted)]",children:"..."})]},e.id)})]})]}):(0,a.jsxs)("div",{className:"text-center text-[var(--text-muted)]",children:[(0,a.jsxs)("div",{className:"text-4xl mb-4 opacity-20 flex justify-center gap-2",children:[(0,a.jsx)("span",{children:"\uD83E\uDEA8"}),(0,a.jsx)("span",{children:"\uD83D\uDCC4"}),(0,a.jsx)("span",{children:"✂️"})]}),(0,a.jsx)("p",{className:"text-sm",children:"defie un joueur depuis le panel"})]})})]})}),(0,a.jsxs)("div",{className:"w-full lg:w-72 border-t lg:border-t-0 lg:border-l border-[var(--line)] flex flex-col",children:[(0,a.jsx)("div",{className:"p-4 border-b border-[var(--line)]",children:(0,a.jsx)(p.Balance,{initialBalance:r})}),(0,a.jsxs)("div",{className:"flex border-b border-[var(--line)]",children:[(0,a.jsx)("button",{onClick:()=>{f("bot"),V()},className:"flex-1 py-2.5 text-[0.65rem] uppercase tracking-[0.15em] transition-colors ".concat("bot"===c?"text-[var(--text)] bg-[rgba(255,255,255,0.03)]":"text-[var(--text-muted)] hover:text-[var(--text)]"),children:"vs bot"}),(0,a.jsx)("button",{onClick:()=>{f("pvp"),V()},className:"flex-1 py-2.5 text-[0.65rem] uppercase tracking-[0.15em] transition-colors ".concat("pvp"===c?"text-[var(--text)] bg-[rgba(255,255,255,0.03)]":"text-[var(--text-muted)] hover:text-[var(--text)]"),children:"vs joueur"})]}),(0,a.jsxs)("div",{className:"p-4 flex-1",children:[(0,a.jsx)("p",{className:"text-[0.65rem] uppercase tracking-[0.2em] text-[var(--text-muted)] mb-3",children:"mise"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,a.jsx)("input",{type:"number",value:b,onChange:e=>j(e.target.value),min:"0.5",step:"0.5",disabled:g,className:"flex-1 px-3 py-2.5 bg-transparent border border-[var(--line)] text-center font-mono focus:outline-none focus:border-[var(--text-muted)] disabled:opacity-50"}),(0,a.jsx)("span",{className:"text-[var(--text-muted)] text-sm",children:"e"})]}),(0,a.jsx)("div",{className:"grid grid-cols-4 gap-1.5 mb-4",children:[.5,1,2,5].map(e=>(0,a.jsx)("button",{onClick:()=>j(e.toString()),disabled:g,className:"py-1.5 text-[0.65rem] border border-[var(--line)] hover:border-[var(--text-muted)] disabled:opacity-50 transition-colors font-mono",children:e},e))}),"pvp"===c&&(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-[0.65rem] uppercase tracking-[0.2em] text-[var(--text-muted)] mb-2 mt-2",children:"joueurs"}),(0,a.jsx)("div",{className:"flex flex-col gap-1.5 max-h-[200px] overflow-auto",children:0===P.length?(0,a.jsx)("p",{className:"text-xs text-[var(--text-muted)] text-center py-4",children:"aucun"}):P.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-2 border border-[var(--line)] hover:border-[var(--text-muted)] transition-colors",children:[(0,a.jsxs)("div",{className:"min-w-0",children:[(0,a.jsx)("p",{className:"text-xs truncate",children:e.name.toLowerCase()}),(0,a.jsxs)("p",{className:"text-[0.6rem] text-[var(--text-muted)] font-mono",children:[e.balance.toFixed(0),"e"]})]}),(0,a.jsx)("button",{onClick:()=>T(e),disabled:g||.5>parseFloat(b),className:"px-2 py-1 text-[0.6rem] uppercase border border-[var(--line)] hover:border-[var(--text-muted)] disabled:opacity-50",children:"go"})]},e.id))})]})]}),(0,a.jsxs)("div",{className:"p-4 border-t border-[var(--line)] text-[0.6rem] text-[var(--text-muted)] space-y-0.5",children:[(0,a.jsx)("p",{children:"pierre > ciseaux"}),(0,a.jsx)("p",{children:"ciseaux > feuille"}),(0,a.jsx)("p",{children:"feuille > pierre"}),(0,a.jsx)("p",{className:"pt-1",children:"victoire x1.9 | egalite -5%"})]})]})]})]})}function b(e){let{userBalance:t,userName:r}=e;return(0,a.jsx)(v.BalanceProvider,{initialBalance:t,children:(0,a.jsx)(f,{userBalance:t,userName:r})})}},8521:(e,t,r)=>{"use strict";r.d(t,{A:()=>c,BalanceProvider:()=>n});var a=r(8481),s=r(8526);let l=(0,s.createContext)(null);function n(e){let{children:t,initialBalance:r}=e,[n,c]=(0,s.useState)(r),[i,d]=(0,s.useState)(parseFloat(r)),[o,x]=(0,s.useState)(0),m=(0,s.useRef)([]),u=(0,s.useRef)(null),p=(0,s.useCallback)((e,t)=>{u.current&&cancelAnimationFrame(u.current);let r=performance.now(),a=s=>{let l=Math.min((s-r)/150,1);d(e+(t-e)*(1-Math.pow(1-l,3))),l<1&&(u.current=requestAnimationFrame(a))};u.current=requestAnimationFrame(a)},[]),v=(0,s.useCallback)(e=>{p(i,parseFloat(e)),c(e)},[i,p]),h=(0,s.useCallback)(e=>{let t=Date.now();m.current.push(t),m.current=m.current.filter(e=>t-e<1e3),x(Math.min(m.current.length/12,1)),c(t=>{let r=parseFloat(t)+e;return p(i,r),r.toFixed(2)})},[i,p]);(0,s.useEffect)(()=>{let e=setInterval(()=>{x(e=>e<=.01?0:.85*e)},50);return()=>clearInterval(e)},[]);let f=(0,s.useCallback)(async()=>{try{let e=await fetch("/api/balance"),t=await e.json(),r=parseFloat(t.balance);p(i,r),c(t.balance)}catch(e){}},[i,p]);return(0,a.jsx)(l.Provider,{value:{balance:n,displayBalance:i,intensity:o,setBalance:v,addToBalance:h,refreshBalance:f},children:t})}function c(e){let t=(0,s.useContext)(l),[r,a]=(0,s.useState)(e),[n,c]=(0,s.useState)(parseFloat(e)),i=(0,s.useCallback)(e=>{a(t=>{let r=parseFloat(t)+e;return c(r),r.toFixed(2)})},[]),d=(0,s.useCallback)(async()=>{try{let e=await fetch("/api/balance"),t=await e.json();a(t.balance),c(parseFloat(t.balance))}catch(e){}},[]);return t||{balance:r,displayBalance:n,intensity:0,setBalance:a,addToBalance:i,refreshBalance:d}}},9381:(e,t,r)=>{"use strict";r.d(t,{M:()=>s});var a=r(6951);let s=(0,a.createServerReference)("00022d10447c8c48e3a6f966bba0c216e4cdca899d",a.callServer,void 0,a.findSourceMapURL,"getAvailablePlayers")}},e=>{e.O(0,[816,59,498,358],()=>e(e.s=4460)),_N_E=e.O()}]);